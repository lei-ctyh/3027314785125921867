# GUI 完整使用指南

## 📌 快速开始

```bash
# 运行主程序
python main.py
```

程序启动后会看到三个界面：
1. **配置输入界面** - 填写登录信息和选择文件
2. **开始前确认对话框** - 提醒手动输入基础信息
3. **完成后确认对话框** - 提醒手动上报

---

## 1️⃣ 配置输入界面

### 界面说明

程序启动后首先显示配置界面，需要填写：

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| **用户名** | 登录网站的账号 | 330621241001 |
| **密码** | 登录网站的密码 | Yaojike2022, |
| **报表月份** | 格式：YYYY-MM | 当前月份 |
| **功能类型** | 门诊/急诊 | 门诊处方用药录入 |
| **输入文件** | Excel数据文件路径 | data/门诊2509.xlsx |
| **无头模式** | 后台运行不显示浏览器 | 不勾选 |

### 界面特性

✅ **支持滚动**
- 窗口右侧有垂直滚动条
- 使用鼠标滚轮上下滚动
- 按钮在最底部

✅ **可调整大小**
- 拖动窗口边缘放大
- 适应不同屏幕尺寸

✅ **输入验证**
- 自动验证必填项
- 检查月份格式
- 验证文件是否存在

✅ **文件浏览器**
- 点击"浏览..."按钮
- 选择Excel数据文件
- 自动转换为相对路径

### 按钮说明

**🟢 开始执行**（右侧，绿色）
- 验证所有输入
- 开始执行自动化流程

**⚪ 取消**（左侧，灰色）
- 取消操作
- 退出程序

### ⚠️ 看不到按钮？

请尝试：
1. 使用**鼠标滚轮**向下滚动
2. 拖动右侧**滚动条**到底部
3. **拖大窗口**（拖动边缘）
4. **向上移动窗口**（避免被任务栏遮挡）

---

## 2️⃣ 开始前确认对话框

### 出现时机
自动登录和导航完成后弹出

### 对话框内容
```
⚠ 请在浏览器中确认以下信息：

1. 请手动输入报表日期
2. 请手动输入门诊总量
3. 确认所有信息无误后，点击"我已完成，继续"按钮

程序将继续自动填写表单数据。
```

### 操作步骤

1. **阅读对话框提示**
   - 了解需要手动完成的操作

2. **切换到浏览器**
   - 查看网页表单
   - 找到报表日期和门诊总量输入框

3. **手动输入数据**
   - 输入报表日期
   - 输入门诊总量

4. **回到对话框**
   - 点击"我已完成，继续"按钮
   - 程序继续执行

### 对话框特性

- ✅ 支持滚动（右侧滚动条）
- ✅ 可调整大小
- ✅ 按钮在底部
- ⚠️ 无法关闭（必须点击确认）

---

## 3️⃣ 完成后确认对话框

### 出现时机
所有数据填写完成后弹出

### 对话框内容
```
⚠ 数据填写完成！

总计：100 条
成功：95 条
失败：5 条

请在浏览器中检查填写结果，确认无误后：
1. 手动点击"上报"按钮
2. 等待上报完成
3. 点击"我已完成，继续"按钮关闭程序
```

### 操作步骤

1. **查看统计结果**
   - 查看成功/失败条数
   - 了解处理情况

2. **检查填写结果**
   - 切换到浏览器
   - 查看填写的数据
   - 确认无误

3. **手动上报**
   - 在浏览器中点击"上报"按钮
   - 等待上报完成

4. **关闭程序**
   - 回到对话框
   - 点击"我已完成，继续"
   - 程序结束

### 对话框特性

- ✅ 显示处理统计
- ✅ 支持滚动
- ✅ 可调整大小
- ⚠️ 无法关闭（必须点击确认）

---

## 🧪 测试工具

### 测试配置界面
```bash
python check_buttons.py
```
检查配置界面按钮是否可见

### 测试确认对话框
```bash
python test_confirmation_dialog.py
```
测试两个确认对话框的显示

### 测试完整GUI
```bash
python test_gui.py
```
测试所有GUI组件

### 查看按钮布局
```bash
python button_layout.py
```
显示配置界面按钮布局图

### 查看详细使用说明
```bash
python gui_usage.py
```
显示完整的使用说明文档

---

## 📋 完整流程演示

```
1. 启动程序
   python main.py
   ↓
2. 【配置界面】
   填写用户名、密码、月份、选择文件
   ↓
   点击"开始执行"
   ↓
3. 浏览器自动打开
   ↓
4. 自动登录
   ↓
5. 自动选择月份
   ↓
6. 自动导航到录入页面
   ↓
7. 【开始前确认对话框】
   ⚠️ 暂停
   → 手动输入报表日期和门诊总量
   → 点击"我已完成，继续"
   ↓
8. 自动读取Excel数据
   ↓
9. 逐条填写表单
   → 显示进度
   ↓
10. 【完成后确认对话框】
    ⚠️ 暂停
    → 查看统计结果
    → 检查填写数据
    → 手动点击上报
    → 点击"我已完成，继续"
    ↓
11. 程序结束
    ↓
12. 查看结果
    → output/ 目录下的Excel文件
    → logs/app.log 日志文件
```

---

## ⚙️ 窗口规格汇总

### 配置输入界面
- 大小：650 × 800 像素
- 可调整：是
- 滚动条：右侧垂直滚动条
- 鼠标滚轮：支持

### 确认对话框
- 大小：550 × 450 像素
- 可调整：是
- 滚动条：右侧垂直滚动条
- 鼠标滚轮：支持
- 关闭按钮：禁用

---

## ❓ 常见问题

### Q1: 看不到按钮怎么办？
**A:** 按钮在窗口最底部
- 使用鼠标滚轮向下滚动
- 拖动右侧滚动条
- 拖大窗口（拖动边缘）

### Q2: 可以跳过手动操作吗？
**A:** 不可以
- 报表日期和门诊总量是必填的基础信息
- 上报操作需要确认数据无误
- 这是业务流程的要求

### Q3: 误点了确认按钮怎么办？
**A:** 程序会继续执行
- 如果在开始前误点：程序会尝试自动填写，但可能因缺少基础信息失败
- 如果在完成后误点：程序会结束，需要手动在浏览器上报

### Q4: 对话框可以关闭吗？
**A:** 不能直接关闭
- 关闭按钮已禁用
- 必须点击"我已完成，继续"按钮
- 如果必须退出，可以使用 Ctrl+C 强制终止

### Q5: 无头模式是什么？
**A:** 后台运行模式
- 勾选后浏览器不显示窗口
- 优点：不占屏幕，更稳定
- 缺点：无法看到操作过程
- 建议：首次使用不要勾选

### Q6: 如何查看处理结果？
**A:** 两个位置
- **Excel文件**：output/ 目录，文件名带时间戳
- **日志文件**：logs/app.log，详细的执行日志

### Q7: 可以修改默认值吗？
**A:** 可以
- 配置界面的默认值可以直接修改
- 下次运行时会使用你输入的值

---

## 💡 使用技巧

1. **首次使用**
   - 不要勾选无头模式
   - 观察浏览器操作过程
   - 熟悉流程后再使用无头模式

2. **批量处理**
   - 准备多个Excel文件
   - 依次运行处理
   - 查看output目录结果

3. **错误处理**
   - 查看logs/app.log了解详情
   - 检查Excel数据格式
   - 验证网络连接

4. **效率优化**
   - 熟练后勾选无头模式
   - 准备好数据文件
   - 减少手动等待时间

---

## 📞 获取帮助

如果遇到问题：

1. **查看文档**
   - `找不到按钮解决方案.md`
   - `确认对话框使用说明.md`
   - `gui_usage.py`

2. **运行测试**
   - `python check_buttons.py`
   - `python test_confirmation_dialog.py`
   - `python test_gui.py`

3. **查看日志**
   - `logs/app.log`

4. **提供信息**
   - 截图窗口画面
   - 复制错误信息
   - 说明屏幕分辨率

---

## 🎉 准备就绪！

现在你可以运行程序了：

```bash
python main.py
```

祝使用愉快！
