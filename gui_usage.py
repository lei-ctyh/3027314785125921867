#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
GUI界面使用说明生成器
运行此脚本查看GUI界面的使用说明
"""

def print_usage():
    """打印GUI使用说明"""

    print("=" * 80)
    print(" " * 20 + "自动化表单填写系统 - GUI使用说明")
    print("=" * 80)

    print("\n【程序启动】")
    print("-" * 80)
    print("运行命令: python main.py")
    print("\n启动后会自动弹出配置界面，需要填写以下信息：")

    print("\n【配置界面说明】")
    print("-" * 80)
    print("""
1. 登录信息
   ├─ 用户名: 登录网站的账号（默认值：330621241001）
   └─ 密码:   登录网站的密码（默认值：Yaojike2022,）

2. 报表配置
   ├─ 报表月份: 格式为 YYYY-MM（默认：当前月份）
   │            示例：2025-09
   │
   └─ 功能类型: 选择要执行的功能
      ├─ ○ 门诊处方用药录入（默认）
      └─ ○ 急诊处方用药录入

3. 数据文件
   └─ 输入文件: 包含要填写数据的Excel文件路径
                ├─ 门诊功能默认: data/门诊2509.xlsx
                ├─ 急诊功能默认: data/emergency_data.xlsx
                └─ 可点击"浏览..."按钮选择其他文件

4. 浏览器配置
   └─ □ 无头模式（后台运行，不显示浏览器窗口）
                ├─ 不勾选：可以看到浏览器操作过程（推荐调试时使用）
                └─ 勾选：  后台运行，不显示浏览器（稳定运行时使用）

5. 重要提示
   └─ 程序执行过程中需要两次手动操作：
      ├─ 第一次：在自动填写前，需要手动输入报表日期和门诊总量
      └─ 第二次：在数据填写完成后，需要手动点击"上报"按钮
""")

    print("【操作步骤】")
    print("-" * 80)
    print("""
步骤1: 填写配置信息
   └─ 在配置界面填写所有必要信息
   └─ 点击"开始执行"按钮

步骤2: 自动登录和导航
   └─ 程序自动打开浏览器
   └─ 自动登录网站
   └─ 自动选择月份
   └─ 自动导航到录入页面

步骤3: 手动输入基本信息（第一次暂停）
   └─ 程序弹出确认对话框
   └─ 在浏览器中手动输入：
      ├─ 报表日期
      └─ 门诊总量
   └─ 完成后点击对话框的"我已完成，继续"按钮

步骤4: 自动批量填写数据
   └─ 程序自动读取Excel文件
   └─ 逐条填写表单数据
   └─ 自动提交每条记录
   └─ 显示处理进度

步骤5: 手动上报（第二次暂停）
   └─ 程序弹出完成对话框，显示处理结果：
      ├─ 总计条数
      ├─ 成功条数
      └─ 失败条数
   └─ 在浏览器中检查填写结果
   └─ 手动点击"上报"按钮
   └─ 等待上报完成
   └─ 点击对话框的"我已完成，继续"按钮

步骤6: 程序结束
   └─ 浏览器自动关闭
   └─ 处理结果已保存到 output/ 目录
   └─ 详细日志保存在 logs/app.log
""")

    print("【配置界面按钮说明】")
    print("-" * 80)
    print("""
[开始执行]  - 验证输入并开始执行自动化流程
[取消]      - 取消操作并退出程序
""")

    print("【确认对话框说明】")
    print("-" * 80)
    print("""
确认对话框在执行过程中会出现两次：

1. 开始前确认对话框
   标题: "开始前确认"
   作用: 提醒用户手动输入报表日期和门诊总量
   按钮: [我已完成，继续]
   注意: 必须点击按钮才能继续，不能直接关闭

2. 上报确认对话框
   标题: "上报确认"
   作用: 提醒用户手动点击上报按钮
   按钮: [我已完成，继续]
   注意: 必须点击按钮才能关闭程序，不能直接关闭
""")

    print("【输入验证】")
    print("-" * 80)
    print("""
配置界面会验证以下内容：
✓ 用户名不能为空
✓ 密码不能为空
✓ 月份格式必须为 YYYY-MM
✓ 输入文件必须存在

如果验证失败，会弹出错误提示对话框。
""")

    print("【常见问题】")
    print("-" * 80)
    print("""
Q: 如何修改默认的用户名和密码？
A: 在配置界面直接修改即可，程序启动时会显示上次使用的值

Q: 可以中途取消吗？
A: 配置界面可以点击"取消"退出，但开始执行后无法中途取消
   可以使用 Ctrl+C 强制终止程序

Q: 如果填写失败怎么办？
A: 程序会记录每条数据的处理结果（成功/失败）
   失败的记录会在结果Excel文件中标记
   可以查看 logs/app.log 了解详细错误信息

Q: 确认对话框可以关闭吗？
A: 确认对话框的关闭按钮已禁用，必须点击"我已完成，继续"按钮

Q: 无头模式是什么？
A: 无头模式让浏览器在后台运行，不显示窗口
   优点：不占用屏幕，运行更稳定
   缺点：无法看到操作过程，调试困难
   建议：首次使用或调试时不要勾选，稳定运行后可勾选

Q: 月份可以选择未来的月份吗？
A: 可以，只要格式正确（YYYY-MM）即可
   实际是否能提交取决于网站的业务规则
""")

    print("【测试GUI】")
    print("-" * 80)
    print("""
如果只想测试GUI界面而不执行完整流程：
命令: python test_gui.py

这会依次显示：
1. 配置输入界面
2. 确认对话框示例

用于验证GUI是否正常工作。
""")

    print("\n" + "=" * 80)
    print(" " * 30 + "祝使用愉快！")
    print("=" * 80)


if __name__ == "__main__":
    print_usage()
