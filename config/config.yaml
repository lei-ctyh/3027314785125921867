# 自动化表单填写配置文件

# 登录配置
login:
  login_url: "http://y.chinadtc.org.cn/login"  # 登录页面URL
  username: "330621241001"  # 登录用户名
  password: "Yaojike2022,"  # 登录密码

  # 登录表单元素定位器（根据实际登录页面修改）
  elements:
    username_field:
      locator: "id"  # 定位方式：id, name, xpath, css_selector
      value: "account"  # 用户名输入框的定位器值

    password_field:
      locator: "id"
      value: "accountPwd"  # 密码输入框的定位器值

    login_button:
      locator: "css_selector"
      value: ".login-btn"  # 登录按钮的定位器值

  # 登录成功验证（用于判断是否登录成功）
  success_indicator:
    type: "url_contains"  # 验证方式：url_contains（URL包含特定字符串）, element_exists（页面存在特定元素）
    value: "http://y.chinadtc.org.cn/entering/"  # 登录成功后URL应该包含的字符串

  # 登录后的确认提示
  confirmation:
    type: "element"  # 提示类型：element（页面元素按钮）, alert（浏览器原生弹窗）
    button:
      locator: "xpath"  # 确认按钮的定位方式
      value: "//button[@onclick='closeShade(this)']"  # 确认按钮定位器
    wait_time: 4  # 等待提示出现的时间（秒）

# 月份选择配置
month_selection:
  month: "current"  # 报表月份：current=当前月，或指定格式如 "2025-10"
  element:
    locator: "id"
    value: "report"  # 月份输入框的 id

  # 月份选择后的确认按钮
  confirm_button:
    locator: "xpath"
    value: "//input[@onclick='subInfo()']"  # 确认按钮定位器

# 录入按钮配置
entry_button:
  locator: "xpath"
  value: "//i[text()='录入功能']"  # 录入按钮定位器
  wait_time: 2  # 等待按钮出现的时间（秒）

# 功能按钮配置
function_button:
  type: "outpatient"  # 功能类型：outpatient=门诊处方用药录入, emergency=急诊处方用药录入
  wait_time: 2  # 等待按钮出现的时间（秒）

  # 门诊处方用药录入按钮
  outpatient:
    locator: "xpath"
    value: "//a[@href='/entering/mjz/index/mjztype/1']"

  # 急诊处方用药录入按钮
  emergency:
    locator: "xpath"
    value: "//a[@href='/entering/mjz/index/mjztype/2']"

# 功能配置（门诊/急诊各自的数据文件和表单配置）
functions:
  # 门诊处方用药录入
  outpatient:
    # 数据文件配置
    data:
      input_file: "data/门诊2509.xlsx"  # 门诊数据文件
      output_file: "output/outpatient_results_{timestamp}.xlsx"  # 门诊结果文件
      sheet_name: "Sheet1"

    # 门诊表单元素定位器配置
    form_elements:
      # 所属科室选择
      科室:
        type: "select"
        locator: "id"
        value: "department"
        description: "普通科室选择框"

      科室2:
        type: "select"
        locator: "id"
        value: "department2"
        description: "儿童医院科室选择框（当选择▲儿童医院科室时显示）"

      # 年龄单位选择（岁/月/周/天）
      年龄单位:
        type: "select"
        locator: "id"
        value: "ageSel"
        options:
          岁: "1"
          月: "2"
          周: "3"
          天: "4"

      # 年龄数值输入
      年龄:
        type: "input"
        locator: "id"
        value: "age"

      # 性别单选（男/女）
      性别:
        type: "radio"
        locator: "name"
        value: "sex"
        options:
          男: "0"
          女: "1"

      # 处方金额
      处方金额:
        type: "input"
        locator: "id"
        value: "outAmount"
        description: "单位：元"

      # 药品品种数
      药品品种数:
        type: "input"
        locator: "id"
        value: "outDrugs"
        description: "单位：种"

      # 有无注射剂（液）
      注射剂:
        type: "radio"
        locator: "name"
        value: "infusion"
        options:
          无: "0"
          有: "1"

      # 注射剂数量（当选择"有"时填写）
      注射剂数量:
        type: "input"
        locator: "id"
        value: "infusionNum"
        description: "单位：种，仅当有无注射剂选择'有'时启用"

      # 诊断1
      诊断1_ID:
        type: "hidden"
        locator: "id"
        value: "diagnosisid1"
      诊断1_名称:
        type: "input"
        locator: "id"
        value: "diagnosisName1"
        placeholder: "诊断名称"
      诊断1_编码:
        type: "input"
        locator: "id"
        value: "diagnosisNums1"
        placeholder: "编码"

      # 诊断2
      诊断2_ID:
        type: "hidden"
        locator: "id"
        value: "diagnosisid2"
      诊断2_名称:
        type: "input"
        locator: "id"
        value: "diagnosisName2"
        placeholder: "诊断名称"
      诊断2_编码:
        type: "input"
        locator: "id"
        value: "diagnosisNums2"
        placeholder: "编码"

      # 诊断3
      诊断3_ID:
        type: "hidden"
        locator: "id"
        value: "diagnosisid3"
      诊断3_名称:
        type: "input"
        locator: "id"
        value: "diagnosisName3"
        placeholder: "诊断名称"
      诊断3_编码:
        type: "input"
        locator: "id"
        value: "diagnosisNums3"
        placeholder: "编码"

      # 诊断4
      诊断4_ID:
        type: "hidden"
        locator: "id"
        value: "diagnosisid4"
      诊断4_名称:
        type: "input"
        locator: "id"
        value: "diagnosisName4"
        placeholder: "诊断名称"
      诊断4_编码:
        type: "input"
        locator: "id"
        value: "diagnosisNums4"
        placeholder: "编码"

      # 诊断5
      诊断5_ID:
        type: "hidden"
        locator: "id"
        value: "diagnosisid5"
      诊断5_名称:
        type: "input"
        locator: "id"
        value: "diagnosisName5"
        placeholder: "诊断名称"
      诊断5_编码:
        type: "input"
        locator: "id"
        value: "diagnosisNums5"
        placeholder: "编码"

      # 保存按钮
      submit_button:
        type: "button"
        locator: "xpath"
        value: "//input[@onclick=\"saveOutpatient('门诊')\"]"
        description: "保存门诊处方用药情况调查表"

      # 重置按钮
      reset_button:
        type: "button"
        locator: "xpath"
        value: "//input[@onclick=\"resetOutpatient('mz')\"]"
        description: "重置表单"

  # 急诊处方用药录入
  emergency:
    # 数据文件配置
    data:
      input_file: "data/emergency_data.xlsx"  # 急诊数据文件
      output_file: "output/emergency_results_{timestamp}.xlsx"  # 急诊结果文件
      sheet_name: "Sheet1"

    # 急诊表单元素定位器配置
    form_elements:
      # 示例：文本输入框（根据实际急诊表单修改）
      patient_name:
        type: "input"
        locator: "id"
        value: "patient_name"

      # 示例：提交按钮
      submit_button:
        type: "button"
        locator: "css_selector"
        value: "button[type='submit']"

# 浏览器配置
browser:
  headless: false  # 是否无头模式（true=后台运行，false=显示浏览器）
  window_size: "1920,1080"  # 浏览器窗口大小
  timeout: 30  # 默认超时时间（秒）

# 日志配置
logging:
  level: "INFO"  # 日志级别：DEBUG, INFO, WARNING, ERROR
  file: "logs/app.log"  # 日志文件路径
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

